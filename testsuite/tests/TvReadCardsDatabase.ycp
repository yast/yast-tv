{
    // testedfiles: Tv.ycp

    include "testsuite.ycp";

    map READ = $[
	"target" : $[ "size": -1, "tmpdir" : "/tmp", ]
    ];

    TESTSUITE_INIT([READ], nil);

    textdomain "tv";
    import "Tv";

    map READ_nil =
    $[ "target":
		$[ "yast2": nil ]
	];

    map READ_empty =
    $[ "target":
		$[ "yast2": [ ] ]
	];

    map READ_db =
	$[ "target": $[ "yast2":
	[
	  $[
	    "cards" : [
		  $[
			"module" : "bttv",
	        "name" : _("Unknown bttv card"),
	        "parameters" : $[
	          "card" : "0"
	        ]
	      ],
	      $[
	        "module" : "bttv",
	        "name" : "TView99 CPH06X",
	        "parameters" : $[
	          "card" : "38"
	        ]
	      ],
	    ],
	    "name" : _("Other vendors")
	  ],
	  $[
	    "cards" : [
	      $[
	        "module" : "bttv",
	        "name" : "ATI TV-Wonder VE",
	        "parameters" : $[
	          "card" : "64"
	        ]
	      ],
		],
	    "name" : "ATI"
	  ],
	]
	]];

	// cannot read the database file (creates err-file due to Report::Error)
	/*
	Tv::cards_database=nil;
    TEST (``(Tv::ReadCardsDatabase()), [ READ_nil, $[], $[] ], nil);
	*/

	// empty database
	Tv::cards_database=nil;
	TEST (``(Tv::ReadCardsDatabase()), [ READ_empty, $[], $[] ], nil);

	// doesn't read the file (card_database is not nil)
	TEST (``(Tv::ReadCardsDatabase()), [ READ_db, $[], $[] ], nil);

	Tv::cards_database=nil;
    TEST (``(Tv::ReadCardsDatabase()), [ READ_db, $[], $[] ], nil);
}
